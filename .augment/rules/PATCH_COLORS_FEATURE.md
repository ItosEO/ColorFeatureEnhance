# 补丁状态颜色区分功能

## 🎨 功能概述

为ColorFeatureEnhance应用添加了卡片颜色区分功能，通过不同的颜色来直观显示特性的补丁状态：

- **绿色卡片** - 新增的特性 (ADD)
- **紫色卡片** - 修改的特性 (MODIFY)  
- **默认颜色** - 未修改的系统原始特性

## 🔧 技术实现

### 核心组件

1. **PatchColors.kt** - 补丁颜色管理工具类
   - 提供浅色/暗色模式适配的颜色方案
   - 统一管理卡片颜色、边框颜色、指示器颜色

2. **ConfigMergeManager** - 补丁状态检测
   - `getFeaturesPatchActions()` - 批量获取特性补丁状态
   - `getFeaturePatchAction()` - 单个特性补丁状态查询

3. **FeatureConfigScreen** - UI集成
   - 在特性加载时同步获取补丁状态
   - 在特性保存后更新补丁状态显示

### 颜色方案

#### 浅色模式
- **ADD**: 浅绿色背景 (#E8F5E8) + 绿色指示器 (#4CAF50)
- **MODIFY**: 浅紫色背景 (#F3E5F5) + 紫色指示器 (#9C27B0)

#### 暗色模式  
- **ADD**: 深绿色背景 (#1B5E20) + 绿色指示器 (#4CAF50)
- **MODIFY**: 深紫色背景 (#4A148C) + 紫色指示器 (#9C27B0)

## 📱 用户体验

### 视觉反馈
- 用户可以一眼看出哪些特性是新增的，哪些是修改过的
- 颜色区分帮助用户快速识别自己的修改内容
- 状态指示器文字提供额外的文本说明

### 状态说明
- **新增** - 用户添加的全新特性，系统原本没有
- **修改** - 用户修改了系统原有特性的参数或状态
- **无标识** - 系统原始特性，未被用户修改

## 🚀 使用方式

功能自动生效，无需用户手动配置：

1. 打开应用后，系统会自动检测补丁状态
2. 新增的特性显示为绿色卡片，带有"新增"标签
3. 修改的特性显示为紫色卡片，带有"修改"标签
4. 未修改的特性保持默认颜色

## 🔄 状态更新

补丁状态会在以下时机自动更新：
- 应用启动时
- 切换配置模式时
- 添加新特性后
- 修改特性后
- 删除特性后

## 💡 设计考虑

### 为什么没有红色(REMOVE)？
删除的特性不会显示在列表中，因此不需要红色来表示REMOVE状态。

### 暗色模式适配
- 使用更深的背景色以保持良好的对比度
- 指示器颜色保持一致，确保品牌识别度

### 性能优化
- 批量获取补丁状态，减少文件I/O操作
- 异步加载，不阻塞UI渲染
- 状态缓存，避免重复计算

## 🛠️ 开发者说明

### 扩展颜色方案
如需添加新的补丁状态颜色，在`Color.kt`中定义新颜色：

```kotlin
// 新状态 - 蓝色系
val PatchNewLight = Color(0xFFE3F2FD)
val PatchNewDark = Color(0xFF0D47A1) 
val PatchNewBorder = Color(0xFF2196F3)
```

### 自定义状态检测
可以在`ConfigMergeManager`中扩展`getFeaturesPatchActions()`方法来支持更复杂的状态检测逻辑。

## 📋 TODO

- [ ] 添加设置选项允许用户关闭颜色区分
- [ ] 支持自定义颜色主题
- [ ] 添加补丁状态统计信息
- [ ] 考虑添加动画效果
